{% extends 'base.html' %}

{% block title %}Gesti贸n de Devoluciones{% endblock %}

{% block content %}
    <div class="container">
        <h2>Gesti贸n de Devoluciones</h2>
        <form method="POST" action="{{ url_for('gestion_devoluciones') }}">
            <div class="form-group">
                <label for="producto">Producto</label>
                <input type="text" class="form-control" id="producto" name="producto" required>
            </div>
            <div class="form-group">
                <label for="motivo">Motivo de Devoluci贸n</label>
                <select class="form-control" id="motivo" name="motivo" required>
                    <option value="">Seleccione un motivo</option>
                    <option value="Producto defectuoso">Producto defectuoso</option>
                    <option value="Fecha de caducidad cercana">Fecha de caducidad cercana</option>
                    <option value="Otro">Otro</option>
                </select>
            </div>
            <div class="form-group">
                <label for="cantidad">Cantidad Devuelta</label>
                <input type="number" class="form-control" id="cantidad" name="cantidad" required>
            </div>
            <button type="submit" class="btn btn-primary">Registrar Devoluci贸n</button>
        </form>

        <div class="mt-3" id="reporte-links">
            <button type="button" class="btn btn-secondary" onclick="generarReporte()">Generar Reporte de Devoluciones</button>
            <div id="mensajeExito" class="alert alert-success mt-3" style="display: none;">
                Reporte generado exitosamente.
            </div>
        </div>
    </div>

    <script>
        function generarReporte() {
            document.getElementById('mensajeExito').style.display = 'block';

            document.getElementById('descargarPDF').addEventListener('click', function(event) {
                event.preventDefault();
                var pdfContent = `
                    <html>
                    <head><title>Reporte de Devoluciones</title></head>
                    <body>
                        <h1>Reporte de Devoluciones</h1>
                        <p>Detalles de las devoluciones.</p>
                    </body>
                    </html>
                `;
                var blob = new Blob([pdfContent], { type: 'application/pdf' });
                var url = URL.createObjectURL(blob);
                var a = document.createElement('a');
                a.href = url;
                a.download = 'reporte_devoluciones.pdf';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });

            document.getElementById('descargarExcel').addEventListener('click', function(event) {
                event.preventDefault();
                var excelContent = `
                    <html>
                    <head><title>Reporte de Devoluciones</title></head>
                    <body>
                        <h1>Reporte de Devoluciones</h1>
                        <p>Detalles de las devoluciones.</p>
                    </body>
                    </html>
                `;
                var blob = new Blob([excelContent], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                var url = URL.createObjectURL(blob);
                var a = document.createElement('a');
                a.href = url;
                a.download = 'reporte_devoluciones.xlsx';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
        }
    </script>
{% endblock %}
