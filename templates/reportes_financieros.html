{% extends 'base.html' %}

{% block title %}Reportes Financieros{% endblock %}

{% block content %}
    <div class="container">
        <h2>Generar Reporte Financiero</h2>
        <form id="form-reporte" method="POST">
            <div class="form-group">
                <label for="mes">Seleccione el mes:</label>
                <select name="mes" id="mes" class="form-control">
                    <option value="Enero">Enero</option>
                    <option value="Febrero">Febrero</option>
                    <option value="Marzo">Marzo</option>
                    <option value="Abril">Abril</option>
                    <option value="Mayo">Mayo</option>
                    <option value="Junio">Junio</option>
                    <option value="Julio">Julio</option>
                    <option value="Agosto">Agosto</option>
                    <option value="Septiembre">Septiembre</option>
                    <option value="Octubre">Octubre</option>
                    <option value="Noviembre">Noviembre</option>
                    <option value="Diciembre">Diciembre</option>
                </select>
            </div>
            <div class="form-group">
                <label for="formato">Seleccione el formato:</label>
                <select name="formato" id="formato" class="form-control">
                    <option value="pdf">PDF</option>
                    <option value="excel">Excel</option>
                </select>
            </div>
            <button type="button" class="btn btn-green" onclick="generarReporte()">Generar Reporte</button>
        </form>

        <div id="mensajeExito" class="alert alert-success mt-3" style="display: none;">
            Reporte generado exitosamente.
        </div>

        <div class="mt-3" id="reporte-links" style="display: none;">
            <a href="#" id="descargarPDF" class="btn btn-secondary">Descargar PDF</a>
            <a href="#" id="descargarExcel" class="btn btn-secondary">Descargar Excel</a>
        </div>
    </div>

    <script>
        function generarReporte() {
            const mes = document.getElementById('mes').value;
            const formato = document.getElementById('formato').value;

            if (!mes || !formato) {
                alert('Por favor seleccione un mes y un formato.');
                return;
            }

            document.getElementById('mensajeExito').style.display = 'block';
            document.getElementById('reporte-links').style.display = 'block';

            document.getElementById('descargarPDF').addEventListener('click', function(event) {
                event.preventDefault();
                const pdfContent = `
                    <html>
                    <head><title>Reporte Financiero</title></head>
                    <body>
                        <h1>Reporte Financiero de ${mes}</h1>
                        <p>Test</p>
                    </body>
                    </html>
                `;
                const blob = new Blob([pdfContent], { type: 'application/pdf' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `reporte_financiero_${mes}.pdf`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });

            document.getElementById('descargarExcel').addEventListener('click', function(event) {
                event.preventDefault();
                const excelContent = `
                    <html>
                    <head><title>Reporte Financiero</title></head>
                    <body>
                        <h1>Reporte Financiero de ${mes}</h1>
                        <p>Test</p>
                    </body>
                    </html>
                `;
                const blob = new Blob([excelContent], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `reporte_financiero_${mes}.xlsx`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });
        }
    </script>
{% endblock %}
